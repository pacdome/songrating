<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOME'S MUSIC COLLECTION</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'MS Sans Serif', 'Tahoma', sans-serif;
            font-size: 11px;
            background: linear-gradient(135deg, #c0c0c0 25%, #e0e0e0 50%, #c0c0c0 75%);
            color: #000;
            min-height: 100vh;
        }
        
        .page-wrapper {
            padding: 10px;
            min-height: 100vh;
        }
        
        .main-container {
            max-width: 900px;
            margin: 0 auto;
            background: #c0c0c0;
            border: 3px outset #c0c0c0;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.5);
        }
        
        .title-bar {
            background: linear-gradient(90deg, #000080 0%, #0000ff 100%);
            color: white;
            padding: 4px 8px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #000040;
        }
        
        .title-text {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
        }
        
        .title-icon {
            width: 16px;
            height: 16px;
            background: #ffff00;
            border: 1px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            color: #000;
        }
        
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .control-btn {
            width: 18px;
            height: 16px;
            background: #c0c0c0;
            border: 1px outset #c0c0c0;
            font-size: 8px;
            color: #000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn:active {
            border: 1px inset #c0c0c0;
        }
        
        .header-zone {
            background: linear-gradient(45deg, #ff99cc, #99ccff);
            border: 2px inset #c0c0c0;
            margin: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .main-title {
            font-family: 'Orbitron', monospace;
            font-size: 24px;
            font-weight: 900;
            color: #000;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.8);
            margin: 0 0 8px 0;
            letter-spacing: 2px;
        }
        
        .subtitle {
            font-size: 14px;
            font-weight: bold;
            color: #800080;
            margin: 5px 0;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }
        
        .loading-banner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000080;
            color: #ffff00;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-family: 'Courier New', monospace;
        }
        
        .loading-text {
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        .loading-progress {
            width: 400px;
            height: 20px;
            border: 2px solid #ffff00;
            background: #000;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff00ff, #00ffff);
            width: 0%;
            animation: progressLoad 3s ease-out forwards;
        }
        
        @keyframes progressLoad {
            to { width: 100%; }
        }
        
        .status-display {
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            padding: 6px;
            margin: 8px;
            border: 2px inset #c0c0c0;
        }
        
        .status-cursor {
            animation: cursorBlink 1s step-start infinite;
        }
        
        @keyframes cursorBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .toolbar-area {
            background: #e0e0e0;
            border: 2px inset #c0c0c0;
            padding: 8px;
            margin: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }
        
        .tool-btn {
            background: linear-gradient(135deg, #c0c0c0 0%, #f0f0f0 50%, #c0c0c0 100%);
            border: 2px outset #c0c0c0;
            padding: 6px 10px;
            font-size: 10px;
            font-weight: bold;
            color: #000;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.1s;
        }
        
        .tool-btn:hover {
            background: linear-gradient(135deg, #d0d0d0 0%, #ffffff 50%, #d0d0d0 100%);
        }
        
        .tool-btn:active, .tool-btn.active {
            border: 2px inset #c0c0c0;
            background: #a0a0a0;
        }
        
        .search-panel {
            background: #f0f0f0;
            border: 2px inset #c0c0c0;
            margin: 8px;
            padding: 10px;
        }
        
        .search-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        
        .search-label {
            font-weight: bold;
            min-width: 70px;
            color: #000080;
        }
        
        .retro-input, .retro-select {
            border: 2px inset #c0c0c0;
            padding: 3px 6px;
            font-size: 11px;
            background: white;
            color: #000;
            font-family: inherit;
        }
        
        .retro-input:focus, .retro-select:focus {
            outline: none;
            border: 2px inset #0000ff;
            background: #f0f8ff;
        }
        
        .content-display {
            background: white;
            border: 3px inset #c0c0c0;
            margin: 8px;
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .album-entry {
            border-bottom: 1px solid #e0e0e0;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .album-entry:hover {
            background: #f0f8ff;
        }
        
        .album-entry.open {
            background: #ffffcc;
        }
        
        .album-header {
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .album-disc {
            width: 32px;
            height: 32px;
            background: radial-gradient(circle, #ffff00 20%, #ff0080 40%, #000 60%);
            border: 2px solid #808080;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px #000;
        }
        
        .album-disc::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #000;
            border-radius: 50%;
        }
        
        .album-details {
            flex: 1;
            min-width: 0;
        }
        
        .album-name {
            font-weight: bold;
            font-size: 12px;
            color: #000080;
            margin-bottom: 2px;
        }
        
        .album-info {
            font-size: 10px;
            color: #666;
        }
        
        .album-score {
            background: linear-gradient(45deg, #ff9999, #ffcc99);
            border: 2px outset #c0c0c0;
            padding: 8px 12px;
            font-weight: bold;
            font-size: 14px;
            color: #000;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
            min-width: 50px;
            text-align: center;
        }
        
        .album-expanded {
            display: none;
            background: #f8f8f8;
            border-top: 1px solid #ccc;
            padding: 12px;
        }
        
        .album-expanded.show {
            display: block;
        }
        
        .tracklist-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
            margin-bottom: 10px;
            border: 1px solid #808080;
        }
        
        .tracklist-table th {
            background: linear-gradient(135deg, #c0c0c0 0%, #e0e0e0 100%);
            border: 1px outset #c0c0c0;
            padding: 4px 6px;
            font-weight: bold;
            color: #000080;
        }
        
        .tracklist-table td {
            border: 1px solid #ccc;
            padding: 3px 6px;
            background: white;
        }
        
        .tracklist-table tr:nth-child(even) td {
            background: #f8f8f8;
        }
        
        .tracklist-table tr:hover td {
            background: #e0f0ff;
        }
        
        .track-rating {
            text-align: center;
            font-weight: bold;
        }
        
        .rating-10, .rating-9 { color: #ff0000; background: #ffcccc; }
        .rating-8, .rating-7 { color: #ff8800; background: #ffe0cc; }
        .rating-6, .rating-5 { color: #00aa00; background: #ccffcc; }
        .rating-low { color: #666; background: #f0f0f0; }
        
        .fav-star {
            color: #ff0000;
            font-weight: bold;
        }
        
        .interlude-text {
            color: #666;
            font-style: italic;
            font-size: 9px;
        }
        
        .comment-box {
            background: #ffffcc;
            border: 2px dashed #cc9900;
            padding: 8px;
            margin-top: 8px;
            font-style: italic;
            font-size: 10px;
            color: #000080;
        }
        
        .comment-box::before {
            content: "💬 MEIN KOMMENTAR: ";
            font-weight: bold;
            font-style: normal;
            color: #800080;
        }
        
        .stats-footer {
            background: linear-gradient(90deg, #c0c0c0 0%, #e0e0e0 50%, #c0c0c0 100%);
            border-top: 2px outset #c0c0c0;
            padding: 8px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            font-size: 10px;
            font-weight: bold;
        }
        
        .stat-box {
            background: linear-gradient(45deg, #ffcc99, #ff9999);
            border: 1px outset #c0c0c0;
            padding: 4px 8px;
            margin: 2px;
            color: #000;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }
        
        .pagination-zone {
            text-align: center;
            padding: 8px;
            background: #f0f0f0;
            margin: 8px;
            border: 1px inset #c0c0c0;
        }
        
        .page-btn {
            background: linear-gradient(135deg, #cc99ff, #99ccff);
            border: 2px outset #c0c0c0;
            color: #000;
            padding: 4px 8px;
            margin: 0 2px;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.1s;
        }
        
        .page-btn:hover {
            background: linear-gradient(135deg, #ddaaff, #aaddff);
        }
        
        .page-btn.active {
            background: #ff9999;
            color: white;
            border: 2px inset #c0c0c0;
        }
        
        .bottom-bar {
            background: linear-gradient(90deg, #000080 0%, #800080 100%);
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 10px;
        }
        
        .web-link {
            color: #ffff00;
            text-decoration: underline;
            cursor: pointer;
        }
        
        .web-link:hover {
            color: #ff99cc;
        }
        
        @media (max-width: 768px) {
            .main-container {
                margin: 5px;
            }
            
            .album-header {
                flex-direction: column;
                text-align: center;
                gap: 5px;
            }
            
            .search-group {
                justify-content: center;
            }
            
            .toolbar-area {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="loading-banner" id="loadingScreen">
        <div class="loading-text">>>> LADE DOME'S MUSIK SAMMLUNG <<<</div>
        <div class="loading-progress">
            <div class="progress-fill"></div>
        </div>
        <div style="margin-top: 15px; font-size: 12px;">
            Lade albums.json...
        </div>
    </div>

    <div class="page-wrapper">
        <div class="main-container">
            <div class="title-bar">
                <div class="title-text">
                    <div class="title-icon">♫</div>
                    DOME'S MUSIC COLLECTION v2.1
                </div>
                <div class="window-controls">
                    <div class="control-btn">_</div>
                    <div class="control-btn">□</div>
                    <div class="control-btn">×</div>
                </div>
            </div>
            
            <div class="header-zone">
                <h1 class="main-title">🎵 DOME'S MUSIC COLLECTION 🎵</h1>
                <div class="subtitle">DIE ULTIMATIVE ALBUM-BEWERTUNGS-DATENBANK</div>
                <div style="font-size: 10px; color: #000080; margin-top: 5px;">
                    Powered by Retro Web Technology
                </div>
            </div>
            
            <div class="status-display">
                STATUS: ONLINE | USER: DOME | 
                ALBEN: <span id="loadedAlbums">0</span> | 
                SONGS: <span id="totalSongs">0</span> | 
                UPDATE: <span id="lastUpdate"></span>
                <span class="status-cursor">█</span>
            </div>
            
            <div class="toolbar-area">
                <div class="tool-btn active" onclick="switchView('home')">
                    🏠 HOME
                </div>
                <div class="tool-btn" onclick="switchView('stats')">
                    📊 STATS
                </div>
                <div class="tool-btn" onclick="switchView('favorites')">
                    ⭐ FAVORITES
                </div>
                <div class="tool-btn" onclick="switchView('top10')">
                    🏆 TOP 10
                </div>
                <div class="tool-btn" onclick="expandAllAlbums()">
                    📂 EXPAND ALL
                </div>
                <div class="tool-btn" onclick="getRandomAlbum()">
                    🎲 RANDOM
                </div>
            </div>
            
            <div class="search-panel">
                <div class="search-group">
                    <div class="search-label">SUCHE:</div>
                    <input type="text" class="retro-input" id="searchField" 
                           placeholder="Album oder Künstler eingeben..." 
                           style="flex: 1; min-width: 200px;" 
                           onkeyup="performSearch()">
                </div>
                <div class="search-group">
                    <div class="search-label">SORTIEREN:</div>
                    <select class="retro-select" id="sortingSelect" onchange="applySorting()">
                        <option value="rating-desc">★ BEWERTUNG (HOCH → NIEDRIG)</option>
                        <option value="rating-asc">★ BEWERTUNG (NIEDRIG → HOCH)</option>
                        <option value="artist-asc">👤 KÜNSTLER (A → Z)</option>
                        <option value="artist-desc">👤 KÜNSTLER (Z → A)</option>
                        <option value="album-asc">💿 ALBUM (A → Z)</option>
                        <option value="album-desc">💿 ALBUM (Z → A)</option>
                        <option value="year-desc">📅 JAHR (NEU → ALT)</option>
                        <option value="year-asc">📅 JAHR (ALT → NEU)</option>
                    </select>
                    <div class="tool-btn" onclick="resetAllFilters()">🔄 RESET</div>
                </div>
            </div>
            
            <div class="content-display" id="mainContent">
            </div>
            
            <div class="pagination-zone" id="paginationArea"></div>
            
            <div class="stats-footer">
                <div class="stat-box">ALBEN: <span id="albumCounter">0</span></div>
                <div class="stat-box">SONGS: <span id="songCounter">0</span></div>
                <div class="stat-box">Ø BEWERTUNG: <span id="avgRating">0.0</span></div>
                <div class="stat-box">FAVORITEN: <span id="favoriteCounter">0</span></div>
                <div class="stat-box">PERFECT 10s: <span id="perfectCounter">0</span></div>
            </div>
            
            <div class="bottom-bar">
                © 2024 DOME'S MUSIC ARCHIVE | 
                <span class="web-link" onclick="showSystemInfo()">SYSTEM INFO</span> | 
                <span class="web-link" onclick="showAbout()">ABOUT</span>
            </div>
        </div>
    </div>

    <script>
        let albumsDatabase = [];
        let currentAlbumList = [];
        let currentPage = 1;
        const itemsPerPage = 6;
        let allExpanded = false;
        let activeView = 'home';

        async function loadAlbumsFromJSON() {
            try {
                const response = await fetch('albums.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.error('Could not load albums.json:', error);
                throw error;
            }
        }

        async function initializeApp() {
            try {
                document.getElementById('loadingScreen').style.display = 'flex';
                
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                albumsDatabase = await loadAlbumsFromJSON();
                currentAlbumList = [...albumsDatabase];
                
                document.getElementById('loadingScreen').style.display = 'none';
                
                applySorting();
                updateAllStats();
                renderActiveView();
                
                console.log('Music collection loaded successfully!');
            } catch (error) {
                console.error('Failed to initialize app:', error);
                document.getElementById('loadingScreen').innerHTML = 
                    '<div style="color: #ff0000; font-size: 18px;">ERROR: KONNTE albums.json NICHT LADEN!</div>' +
                    '<div style="margin-top: 10px;">Bitte überprüfen Sie die Datei.</div>';
            }
        }

        function getAlbumAverageRating(album) {
            const validSongs = album.songs.filter(song => !song.interlude);
            if (validSongs.length === 0) return 0;
            const total = validSongs.reduce((sum, song) => sum + song.rating, 0);
            return (total / validSongs.length).toFixed(1);
        }

        function getRatingColorClass(rating) {
            const numRating = parseFloat(rating);
            if (numRating >= 9) return 'rating-10';
            if (numRating >= 7) return 'rating-8';
            if (numRating >= 5) return 'rating-6';
            return 'rating-low';
        }

        function switchView(viewName) {
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            activeView = viewName;
            currentPage = 1;
            renderActiveView();
        }

        function renderActiveView() {
            switch(activeView) {
                case 'home':
                    renderAlbumsList();
                    break;
                case 'stats':
                    renderStatsView();
                    break;
                case 'favorites':
                    renderFavoritesView();
                    break;
                case 'top10':
                    renderTop10View();
                    break;
                default:
                    renderAlbumsList();
            }
        }

        function renderAlbumsList() {
            const content = document.getElementById('mainContent');
            content.innerHTML = '';
            
            const startIdx = (currentPage - 1) * itemsPerPage;
            const endIdx = startIdx + itemsPerPage;
            const pageAlbums = currentAlbumList.slice(startIdx, endIdx);
            
            pageAlbums.forEach((album, index) => {
                const globalIndex = startIdx + index;
                const avgRating = getAlbumAverageRating(album);
                
                const albumDiv = document.createElement('div');
                albumDiv.className = 'album-entry';
                albumDiv.innerHTML = `
                    <div class="album-header" onclick="toggleAlbumExpansion(${globalIndex})">
                        <div class="album-disc">♫</div>
                        <div class="album-details">
                            <div class="album-name">${album.artist} - ${album.album}</div>
                            <div class="album-info">
                                Jahr: ${album.year} | Tracks: ${album.songs.length} | 
                                Durchschnitt: ${avgRating}/10
                            </div>
                        </div>
                        <div class="album-score ${getRatingColorClass(avgRating)}">${avgRating}</div>
                    </div>
                    <div class="album-expanded" id="expanded-${globalIndex}">
                        ${generateTracklistTable(album.songs)}
                        ${album.comment ? `<div class="comment-box">${album.comment}</div>` : ''}
                    </div>
                `;
                content.appendChild(albumDiv);
            });
            
            updatePaginationControls();
        }

        function generateTracklistTable(songs) {
            let html = `
                <table class="tracklist-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Song Title</th>
                            <th>Rating</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            songs.forEach((song, idx) => {
                html += `
                    <tr ${song.interlude ? 'class="interlude-text"' : ''}>
                        <td>${idx + 1}</td>
                        <td>${song.name} ${song.interlude ? '(Interlude)' : ''}</td>
                        <td class="track-rating ${getRatingColorClass(song.rating)}">${song.rating}</td>
                        <td>
                            ${song.favorite ? '<span class="fav-star">★ FAV</span>' : ''}
                            ${song.interlude ? '<span class="interlude-text">Interlude</span>' : ''}
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            return html;
        }

        function toggleAlbumExpansion(index) {
            const expandedDiv = document.getElementById(`expanded-${index}`);
            const albumEntry = expandedDiv.closest('.album-entry');
            
            if (expandedDiv.classList.contains('show')) {
                expandedDiv.classList.remove('show');
                albumEntry.classList.remove('open');
            } else {
                expandedDiv.classList.add('show');
                albumEntry.classList.add('open');
            }
        }

        function renderStatsView() {
            const content = document.getElementById('mainContent');
            
            const totalSongs = albumsDatabase.reduce((sum, album) => sum + album.songs.length, 0);
            const totalFavorites = albumsDatabase.reduce((sum, album) => 
                sum + album.songs.filter(s => s.favorite).length, 0);
            const totalInterludes = albumsDatabase.reduce((sum, album) => 
                sum + album.songs.filter(s => s.interlude).length, 0);
            
            const allValidRatings = albumsDatabase.flatMap(album => 
                album.songs.filter(s => !s.interlude).map(s => s.rating));
            const overallAvg = allValidRatings.reduce((a, b) => a + b, 0) / allValidRatings.length;
            
            const distribution = {};
            for (let i = 1; i <= 10; i++) {
                distribution[i] = allValidRatings.filter(r => 
                    Math.floor(r) === i || (i === 10 && r === 10)).length;
            }
            
            let html = `
                <div style="padding: 20px; background: #f8f8f8;">
                    <h2 style="color: #000080; font-family: 'Orbitron', monospace; text-align: center; margin-bottom: 20px;">
                        📊 SAMMLUNGS-STATISTIKEN 📊
                    </h2>
                    
                    <table class="tracklist-table" style="margin-bottom: 20px;">
                        <tr><th>Kategorie</th><th>Anzahl</th></tr>
                        <tr><td>Gesamte Alben</td><td>${albumsDatabase.length}</td></tr>
                        <tr><td>Gesamte Songs</td><td>${totalSongs}</td></tr>
                        <tr><td>Favoriten</td><td>${totalFavorites}</td></tr>
                        <tr><td>Interludes</td><td>${totalInterludes}</td></tr>
                        <tr><td>Gesamtbewertung</td><td>${overallAvg.toFixed(2)}/10</td></tr>
                    </table>
                    
                    <h3 style="color: #800080; margin: 20px 0 10px 0;">Bewertungsverteilung:</h3>
                    <table class="tracklist-table">
                        <tr><th>Rating</th><th>Anzahl Songs</th><th>Prozent</th></tr>
            `;
            
            for (let i = 10; i >= 1; i--) {
                const count = distribution[i] || 0;
                const percent = ((count / allValidRatings.length) * 100).toFixed(1);
                html += `<tr><td>${i}/10</td><td>${count}</td><td>${percent}%</td></tr>`;
            }
            
            html += '</table></div>';
            
            content.innerHTML = html;
            document.getElementById('paginationArea').innerHTML = '';
        }

        function renderFavoritesView() {
            const content = document.getElementById('mainContent');
            const favorites = [];
            
            albumsDatabase.forEach(album => {
                album.songs.filter(s => s.favorite).forEach(song => {
                    favorites.push({
                        artist: album.artist,
                        album: album.album,
                        song: song.name,
                        rating: song.rating
                    });
                });
            });
            
            favorites.sort((a, b) => b.rating - a.rating);
            
            let html = `
                <div style="padding: 20px; background: #ffffcc;">
                    <h2 style="color: #800080; font-family: 'Orbitron', monospace; text-align: center; margin-bottom: 20px;">
                        ⭐ MEINE LIEBLINGSSONGS ⭐
                    </h2>
                    
                    <table class="tracklist-table">
                        <tr><th>Künstler</th><th>Album</th><th>Song</th><th>Rating</th></tr>
            `;
            
            favorites.forEach(fav => {
                html += `
                    <tr>
                        <td>${fav.artist}</td>
                        <td>${fav.album}</td>
                        <td>${fav.song}</td>
                        <td class="track-rating ${getRatingColorClass(fav.rating)}">
                            <span class="fav-star">★</span> ${fav.rating}
                        </td>
                    </tr>
                `;
            });
            
            html += `
                    </table>
                    
                    <div style="margin-top: 15px; text-align: center; font-weight: bold; color: #000080;">
                        Gesamt: ${favorites.length} Lieblingssongs gefunden!
                    </div>
                </div>
            `;
            
            content.innerHTML = html;
            document.getElementById('paginationArea').innerHTML = '';
        }

        function renderTop10View() {
            const content = document.getElementById('mainContent');
            const allSongs = [];
            
            albumsDatabase.forEach(album => {
                album.songs.filter(s => !s.interlude).forEach(song => {
                    allSongs.push({
                        artist: album.artist,
                        album: album.album,
                        song: song.name,
                        rating: song.rating,
                        favorite: song.favorite
                    });
                });
            });
            
            allSongs.sort((a, b) => b.rating - a.rating);
            const top10 = allSongs.slice(0, 10);
            
            let html = `
                <div style="padding: 20px; background: #ffcccc;">
                    <h2 style="color: #800000; font-family: 'Orbitron', monospace; text-align: center; margin-bottom: 20px;">
                        🏆 TOP 10 BESTBEWERTETE SONGS 🏆
                    </h2>
                    
                    <table class="tracklist-table">
                        <tr><th>Rank</th><th>Künstler</th><th>Album</th><th>Song</th><th>Rating</th><th>Status</th></tr>
            `;
            
            top10.forEach((song, idx) => {
                const medal = idx < 3 ? ['🥇', '🥈', '🥉'][idx] : `#${idx + 1}`;
                html += `
                    <tr style="${idx < 3 ? 'background: #ffff99;' : ''}">
                        <td style="font-weight: bold; font-size: 12px;">${medal}</td>
                        <td>${song.artist}</td>
                        <td>${song.album}</td>
                        <td>${song.song}</td>
                        <td class="track-rating ${getRatingColorClass(song.rating)}">${song.rating}</td>
                        <td>${song.favorite ? '<span class="fav-star">★</span>' : ''}</td>
                    </tr>
                `;
            });
            
            html += `
                    </table>
                    
                    <div style="margin-top: 15px; text-align: center; font-weight: bold; color: #800000;">
                        Die absolute Elite meiner Musiksammlung!
                    </div>
                </div>
            `;
            
            content.innerHTML = html;
            document.getElementById('paginationArea').innerHTML = '';
        }

        function performSearch() {
            const searchTerm = document.getElementById('searchField').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                currentAlbumList = [...albumsDatabase];
            } else {
                currentAlbumList = albumsDatabase.filter(album =>
                    album.album.toLowerCase().includes(searchTerm) ||
                    album.artist.toLowerCase().includes(searchTerm) ||
                    album.songs.some(song => song.name.toLowerCase().includes(searchTerm))
                );
            }
            
            currentPage = 1;
            if (activeView === 'home') {
                renderAlbumsList();
            }
        }

        function applySorting() {
            const sortValue = document.getElementById('sortingSelect').value;
            const [criteria, direction] = sortValue.split('-');
            
            currentAlbumList.sort((a, b) => {
                let comparison = 0;
                
                switch(criteria) {
                    case 'artist':
                        comparison = a.artist.localeCompare(b.artist, 'de');
                        break;
                    case 'album':
                        comparison = a.album.localeCompare(b.album, 'de');
                        break;
                    case 'year':
                        comparison = a.year - b.year;
                        break;
                    case 'rating':
                        const avgA = parseFloat(getAlbumAverageRating(a));
                        const avgB = parseFloat(getAlbumAverageRating(b));
                        comparison = avgA - avgB;
                        break;
                }
                
                return direction === 'desc' ? -comparison : comparison;
            });
            
            currentPage = 1;
            if (activeView === 'home') {
                renderAlbumsList();
            }
        }

        function resetAllFilters() {
            document.getElementById('searchField').value = '';
            document.getElementById('sortingSelect').value = 'rating-desc';
            currentAlbumList = [...albumsDatabase];
            currentPage = 1;
            applySorting();
        }

        function expandAllAlbums() {
            allExpanded = !allExpanded;
            const expandedDivs = document.querySelectorAll('.album-expanded');
            const albumEntries = document.querySelectorAll('.album-entry');
            
            expandedDivs.forEach(div => {
                if (allExpanded) {
                    div.classList.add('show');
                } else {
                    div.classList.remove('show');
                }
            });
            
            albumEntries.forEach(entry => {
                if (allExpanded) {
                    entry.classList.add('open');
                } else {
                    entry.classList.remove('open');
                }
            });
            
            event.target.textContent = allExpanded ? '📁 COLLAPSE ALL' : '📂 EXPAND ALL';
        }

        function getRandomAlbum() {
            if (currentAlbumList.length === 0) return;
            
            const randomIndex = Math.floor(Math.random() * currentAlbumList.length);
            const randomAlbum = currentAlbumList[randomIndex];
            
            alert(`🎲 ZUFÄLLIGES ALBUM:\n\n${randomAlbum.artist} - ${randomAlbum.album} (${randomAlbum.year})\n\nDurchschnittsbewertung: ${getAlbumAverageRating(randomAlbum)}/10\n\n${randomAlbum.comment || 'Kein Kommentar verfügbar.'}`);
        }

        function updatePaginationControls() {
            const totalPages = Math.ceil(currentAlbumList.length / itemsPerPage);
            const pagination = document.getElementById('paginationArea');
            
            let html = '';
            
            if (totalPages > 1) {
                if (currentPage > 1) {
                    html += `<span class="page-btn" onclick="navigateToPage(${currentPage - 1})">« ZURÜCK</span>`;
                }
                
                for (let i = 1; i <= totalPages; i++) {
                    if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                        html += `<span class="page-btn ${i === currentPage ? 'active' : ''}" onclick="navigateToPage(${i})">${i}</span>`;
                    } else if (i === currentPage - 2 || i === currentPage + 2) {
                        html += '<span style="padding: 0 5px;">...</span>';
                    }
                }
                
                if (currentPage < totalPages) {
                    html += `<span class="page-btn" onclick="navigateToPage(${currentPage + 1})">WEITER »</span>`;
                }
            }
            
            pagination.innerHTML = html;
        }

        function navigateToPage(page) {
            const totalPages = Math.ceil(currentAlbumList.length / itemsPerPage);
            if (page < 1 || page > totalPages) return;
            
            currentPage = page;
            renderAlbumsList();
        }

        function updateAllStats() {
            const totalAlbums = albumsDatabase.length;
            const totalSongs = albumsDatabase.reduce((sum, album) => sum + album.songs.length, 0);
            const totalFavorites = albumsDatabase.reduce((sum, album) => 
                sum + album.songs.filter(s => s.favorite).length, 0);
            const perfectRatings = albumsDatabase.reduce((sum, album) => 
                sum + album.songs.filter(s => s.rating === 10).length, 0);
            
            const allValidRatings = albumsDatabase.flatMap(album => 
                album.songs.filter(s => !s.interlude).map(s => s.rating));
            const avgRating = allValidRatings.length > 0 ? 
                (allValidRatings.reduce((a, b) => a + b, 0) / allValidRatings.length).toFixed(2) : '0.00';
            
            document.getElementById('loadedAlbums').textContent = totalAlbums;
            document.getElementById('totalSongs').textContent = totalSongs;
            document.getElementById('lastUpdate').textContent = new Date().toLocaleDateString('de-DE');
            
            document.getElementById('albumCounter').textContent = totalAlbums;
            document.getElementById('songCounter').textContent = totalSongs;
            document.getElementById('avgRating').textContent = avgRating;
            document.getElementById('favoriteCounter').textContent = totalFavorites;
            document.getElementById('perfectCounter').textContent = perfectRatings;
        }

        function showSystemInfo() {
            alert('💻 SYSTEM INFORMATION 💻\n\n' +
                  'Application: DOME\'s Music Collection v2.1\n' +
                  'Format: JSON Database\n' +
                  'Albums: ' + albumsDatabase.length + '\n' +
                  'Total Songs: ' + albumsDatabase.reduce((sum, album) => sum + album.songs.length, 0) + '\n\n' +
                  'Status: All systems operational!');
        }

        function showAbout() {
            alert('ℹ️ ÜBER DOME\'S MUSIC ARCHIVE ℹ️\n\n' +
                  'Version: 2.1\n' +
                  'Erstellt von: DOME\n' +
                  'Datenformat: JSON\n\n' +
                  'Diese Seite dokumentiert meine persönliche\n' +
                  'Albumsammlung mit detaillierten Bewertungen.\n\n' +
                  '© 2024 DOME Productions');
        }

        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchField').focus();
            }
            
            if (e.key === 'Escape') {
                document.querySelectorAll('.album-expanded.show').forEach(div => {
                    div.classList.remove('show');
                    div.closest('.album-entry').classList.remove('open');
                });
            }
            
            if (e.code === 'Space' && e.target === document.body) {
                e.preventDefault();
                getRandomAlbum();
            }
        });

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
